---
title: SSH Access Setup
description: How to set up SSH access to your xCloud server.
sidebar:
  order: 0
---

import Mermaid from '../../../components/Mermaid.astro';
import RelatedDocs from '../../../components/RelatedDocs.astro';

This guide covers setting up SSH key authentication for your xCloud server.

<Mermaid title="SSH Connection Flow">
{`sequenceDiagram
    participant Local as Your Mac
    participant xCloud as xCloud Dashboard
    participant Server as xCloud Server

    Local->>Local: Generate SSH key pair
    Local->>Local: Copy public key
    Local->>xCloud: Add public key to SSH settings
    xCloud->>Server: Sync authorized keys
    Local->>Server: SSH connection request
    Server->>Server: Verify key signature
    Server->>Local: Connection established
`}
</Mermaid>

## Generate an SSH Key

If you don't have an SSH key, create one:

```bash
ssh-keygen -t ed25519 -f ~/.ssh/id_xcloud
```

You'll be prompted for a passphrase. macOS Keychain will remember it after first use.

## Add Your Key to xCloud

1. Copy your public key:
   ```bash
   cat ~/.ssh/id_xcloud.pub | pbcopy
   ```

2. In xCloud, go to your **Site → Access Data → SSH/sFTP**

3. Click **"+ Add SSH Key"**

4. Paste your public key (must be one continuous line)

5. Give it a name (e.g., "MacBook")

6. Click **Add SSH Key**

7. **Important:** Click **Save** at the bottom of the page

## Connect to Your Server

```bash
ssh -i ~/.ssh/id_xcloud username@your-server-ip
```

Your SSH string is shown in the xCloud dashboard under **Access Data → SSH/sFTP**.

## First Connection

On first connect, you'll see a fingerprint verification prompt:

```
The authenticity of host 'x.x.x.x' can't be established.
ED25519 key fingerprint is SHA256:xxxxx
Are you sure you want to continue connecting (yes/no)?
```

Type `yes` to add the server to your known hosts.

## Troubleshooting

### Permission denied (publickey)

- Ensure you clicked **Save** after adding the key in xCloud
- Wait 1-2 minutes for the key to propagate
- Verify the correct key is being used: `ssh -v -i ~/.ssh/id_xcloud user@host`

### Key must be valid OpenSSH format

When pasting your key in xCloud, ensure:
- It's all on one continuous line
- Starts with `ssh-ed25519` or `ssh-rsa`
- No extra line breaks or spaces

## Using with Claude Code

Claude Code can connect to your xCloud server via SSH, enabling AI-assisted server management, Docker operations, and troubleshooting. This is particularly useful for complex tasks like [configuring Ollama memory](/xcloud/ollama-memory-configuration/) or [updating Docker apps](/xcloud/updating-docker-apps/).

<Mermaid title="Claude Code + xCloud Integration">
{`flowchart TB
    subgraph Local["Your Machine"]
        Claude[Claude Code]
        SSH[SSH Key]
        Config[~/.claude/settings.json]
    end

    subgraph xCloud["xCloud Server"]
        SSHDaemon[SSH Daemon]
        Docker[Docker Engine]
        Apps[Docker Apps]
    end

    subgraph Dashboard["xCloud Dashboard"]
        Runner[Command Runner]
    end

    Claude -->|"Reads"| Config
    Claude -->|"Uses"| SSH
    SSH -->|"Connects"| SSHDaemon
    SSHDaemon -->|"File operations"| Apps
    SSHDaemon -.->|"No access"| Docker
    Runner -->|"Root access"| Docker
    Docker --> Apps

    style Docker fill:#f96,stroke:#333
    style Runner fill:#9f6,stroke:#333
`}
</Mermaid>

### Setting Up Claude Code for SSH Access

#### Method 1: Command Permissions (settings.json)

Configure SSH as an allowed command in your Claude Code settings. Create or edit `~/.claude/settings.json`:

```json
{
  "permissions": {
    "allow": [
      "Bash(ssh -i ~/.ssh/id_xcloud *)",
      "Bash(scp -i ~/.ssh/id_xcloud *)"
    ]
  }
}
```

This allows Claude to:
- Run SSH commands to any host using your xCloud key
- Transfer files via SCP

#### Method 2: Environment Variables

For repeated sessions, set environment variables in your shell profile (`~/.zshrc` or `~/.bashrc`):

```bash
# xCloud SSH Configuration
export XCLOUD_SSH_KEY="$HOME/.ssh/id_xcloud"
export XCLOUD_USER="your-username"
export XCLOUD_HOST="your-server-ip"
export XCLOUD_DOMAIN="your-domain.com"
```

Then tell Claude to use these variables:

```bash
ssh -i $XCLOUD_SSH_KEY $XCLOUD_USER@$XCLOUD_HOST
```

#### Method 3: SSH Config (Recommended)

For the cleanest setup, add to `~/.ssh/config`:

```
Host xcloud
    HostName your-server-ip
    User your-username
    IdentityFile ~/.ssh/id_xcloud
    AddKeysToAgent yes
```

Then add to Claude Code permissions:

```json
{
  "permissions": {
    "allow": [
      "Bash(ssh xcloud *)",
      "Bash(scp xcloud:* *)",
      "Bash(scp * xcloud:*)"
    ]
  }
}
```

Now Claude can simply use:
```bash
ssh xcloud "command here"
```

### What Claude Can Do Via SSH

Once configured, Claude can run commands on your server:

**Check server status:**
```bash
ssh xcloud "uptime && df -h && free -m"
```

**Read configuration files:**
```bash
ssh xcloud "cat /var/www/your-domain.com/docker-compose.yml"
```

**Edit files (using sed or heredoc):**
```bash
ssh xcloud "sed -i 's/old-value/new-value/' /var/www/your-domain.com/.env"
```

**Check logs:**
```bash
ssh xcloud "tail -100 /var/log/nginx/error.log"
```

**Manage services:**
```bash
ssh xcloud "sudo systemctl status nginx"
```

> **Note:** Running `sudo` commands via SSH requires the SSH user to have passwordless sudo privileges configured on the server. On default xCloud setups, this may not be available. Use the xCloud Command Runner for commands requiring root access.

### SSH Limitations: Docker Access

> **Important:** Docker commands (`docker ps`, `docker exec`, etc.) **cannot** be run via SSH on xCloud. The SSH user doesn't have Docker socket permissions.

<Mermaid title="SSH vs Command Runner Permissions">
{`flowchart LR
    subgraph SSH["SSH Connection"]
        SSHUser[SSH User]
        Socket1[Docker Socket]
        SSHUser -.->|"Permission Denied"| Socket1
    end

    subgraph Runner["Command Runner"]
        Root[Root Context]
        Socket2[Docker Socket]
        Root -->|"Full Access"| Socket2
    end
`}
</Mermaid>

For Docker operations, use the **xCloud Command Runner** (Server Dashboard > Management > Commands).

### Working with Claude + Command Runner

Since Claude can't directly run Docker commands, use this workflow:

**Step 1:** Run Docker command in xCloud Command Runner
```bash
docker ps
```

**Step 2:** Copy the output and paste it to Claude

**Step 3:** Claude analyzes and provides next steps

**Example: Diagnosing Ollama Memory Issues**

Run in Command Runner:
```bash
docker inspect $(docker ps -q --filter name=ollama) | grep -i memory
```

Paste output to Claude. Claude will recognize patterns like:
- `"Memory": 2147483648` = 2GB limit (often too low)
- `"Memory": 12884901888` = 12GB limit (good for most models)

Claude can then generate the exact commands to fix it:
```bash
# Stop and remove old container
docker stop ollama-your-domain.com && docker rm ollama-your-domain.com

# Recreate with more memory
docker run -d --name ollama-your-domain.com \
  --memory=12g \
  --restart unless-stopped \
  -p 127.0.0.1:18016:11434 \
  -v /var/www/your-domain.com/data:/root/.ollama \
  ollama/ollama:latest
```

### Real-World Example: Ollama + Open WebUI Setup

This example shows the full workflow used to configure Ollama memory on xCloud:

**1. Diagnose the problem** (Command Runner)
```bash
# Check current memory limit
docker inspect ollama-your-domain.com | grep '"Memory"'

# Check model requirements
# llama2-uncensored (7B): ~4.5GB
# deepseek-r1:1.5b: ~2GB
# llama2:13b: ~8GB
```

**2. Get container config before removing** (Command Runner)
```bash
docker inspect ollama-your-domain.com --format '{{range .Mounts}}{{.Source}}:{{.Destination}}{{"\n"}}{{end}}'
# Output: /var/www/your-domain.com/data:/root/.ollama
```

**3. Recreate with more memory** (Command Runner)
```bash
docker stop ollama-your-domain.com && docker rm ollama-your-domain.com

docker run -d --name ollama-your-domain.com \
  --memory=12g \
  --restart unless-stopped \
  -p 127.0.0.1:18016:11434 \
  -v /var/www/your-domain.com/data:/root/.ollama \
  ollama/ollama:latest
```

**4. Reconnect to Open WebUI network** (Command Runner)
```bash
# Find the network
docker inspect $(docker ps -q --filter name=openweb) --format '{{range $k, $v := .NetworkSettings.Networks}}{{$k}}{{end}}'

# Connect Ollama (alias is critical for Open WebUI)
docker network connect --alias ollama <NETWORK_NAME> ollama-your-domain.com
```

**5. Verify** (Command Runner)
```bash
docker inspect ollama-your-domain.com --format '{{.HostConfig.Memory}}'
# Should return: 12884901888 (12GB)
```

Throughout this process, Claude can help you understand error messages, suggest memory values, and generate the exact commands.

### Docker Command Reference

Commands to run in **xCloud Command Runner** (not SSH):

| Task | Command |
|------|---------|
| List containers | `docker ps` |
| Find specific container | `docker ps -q --filter name=ollama` |
| Check memory limit | `docker inspect container-name \| grep -i memory` |
| Get volume mounts | `docker inspect container-name --format '{{range .Mounts}}{{.Source}}:{{.Destination}}{{"\\n"}}{{end}}'` |
| Pull latest image | `docker pull image:tag` |
| View logs | `docker logs container-name` |
| Restart with compose | `cd /var/www/domain && docker compose up -d` |
| Find container network | `docker inspect container-name --format '{{range $k, $v := .NetworkSettings.Networks}}{{$k}}{{end}}'` |
| Connect to network | `docker network connect --alias name network container` |

### Session Management with Claude

For extended troubleshooting sessions, use Claude Code's session commands:

```bash
# Save your session context
/context-save xcloud-ollama

# Later, restore it
/context-restore xcloud-ollama

# Quick reminder of current context
/remind
```

This preserves all the server details, commands run, and troubleshooting progress.

### Troubleshooting with Claude

**Claude can help diagnose issues when you provide:**

1. **Error messages** - Paste the exact error text
2. **Command output** - Results from `docker ps`, `docker logs`, etc.
3. **Configuration files** - Contents of `docker-compose.yml`, `.env`
4. **System info** - Output from `df -h`, `free -m`, `uptime`

**Example prompt to Claude:**
> I'm getting "model requires more system memory (4.5 GiB) than is available (2.0 GiB)" when trying to run llama2-uncensored on Ollama. Here's my docker inspect output: [paste output]. How do I fix this?

Claude will walk you through the exact steps to resolve it

<RelatedDocs links={[
  { href: '/xcloud/updating-docker-apps/', label: 'Updating Docker Apps', description: 'How to update Docker containers on xCloud' },
  { href: '/xcloud/ollama-memory-configuration/', label: 'Ollama Memory Config', description: 'Configure memory for Ollama on xCloud' },
  { href: '/claude-code/', label: 'Claude Code Setup', description: 'Custom Claude Code configuration and workflows' }
]} />
