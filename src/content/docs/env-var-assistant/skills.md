---
title: Claude Code Skills
description: Skills for secrets auditing and .env.example generation with 1Password
source_project: /Users/jb/env-var-assistant
sidebar:
  order: 6
---

Two Claude Code skills integrate with the env-var-assistant MCP server for security auditing and environment variable management.

## /secrets-audit

Comprehensive security scan that:
- Detects hardcoded API keys in source code
- Finds `.env` files not in `.gitignore`
- Identifies `process.env.*` references without matching 1Password entries

### Usage

```bash
/secrets-audit              # Full audit
/secrets-audit --fix        # Audit + offer to store missing keys
/secrets-audit --quick      # Skip 1Password cross-check
```

### What It Checks

#### 1. Hardcoded Secrets

Scans for provider-specific patterns:

| Pattern | Provider |
|---------|----------|
| `sk-proj-*`, `sk-*` | OpenAI |
| `ghp_*`, `gho_*`, `ghs_*` | GitHub |
| `sk_live_*`, `sk_test_*` | Stripe |
| `xoxb-*`, `xoxp-*` | Slack |
| `AKIA*` (16 chars) | AWS |
| `SG.*` | SendGrid |

Also checks generic patterns: `api_key`, `secret`, `token`, `password`, `credential`

#### 2. .env File Security

Verifies `.gitignore` contains:
```
.env
.env.local
.env*.local
.env.production
```

Flags any `.env*` files that could be committed to git.

#### 3. 1Password Cross-Reference

Uses MCP tools to:
1. Extract all `process.env.*` references from code
2. Call `list_api_keys` to get stored keys
3. Compare: which env vars are NOT in 1Password?
4. Offer to store missing keys (with `--fix`)

### Output Format

```markdown
## Secrets Audit Report

### CRITICAL: Hardcoded Secrets Found
- src/api.ts:42 - OpenAI API key detected (sk-proj-...)

### WARNING: .env Files Not in .gitignore
- .env.local (not gitignored)

### INFO: Missing from 1Password
- DATABASE_URL (referenced in 4 files)
- REDIS_URL (referenced in 2 files)

### Summary
- Critical: 1
- Warning: 1
- Info: 2
```

### MCP Tools Used

- `list_api_keys` - Get all stored keys from 1Password
- `search_items` - Search for specific keys
- `store_api_key` - Store new keys (with `--fix` flag)

---

## /env-example

Generate `.env.example` from 1Password items and code scanning.

### Usage

```bash
/env-example              # Generate from 1Password + code scan
/env-example --1p-only    # Only keys from 1Password
/env-example --code-only  # Only from code scan
/env-example --sync       # Update existing, preserve comments
/env-example --dry-run    # Preview without writing
```

### How It Works

1. **Scans code** for environment variable references:
   - `process.env.VARIABLE_NAME`
   - `import.meta.env.VARIABLE_NAME`
   - `os.environ["VARIABLE_NAME"]` (Python)
   - `ENV["VARIABLE_NAME"]` (Ruby)

2. **Queries 1Password** via `list_api_keys` MCP tool

3. **Generates grouped output** with helpful comments:

```bash
# .env.example
# Generated by /env-example
# Copy to .env and fill in your values

# ===================
# AI / LLM Services
# ===================
# OpenAI - https://platform.openai.com/api-keys
OPENAI_API_KEY=your_openai_api_key_here

# ===================
# Payment Processing
# ===================
# Stripe - https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=your_stripe_secret_key_here

# ===================
# Database
# ===================
DATABASE_URL=your_database_url_here
```

### Provider Categories

Variables are grouped by category:

1. **AI / LLM Services** - OpenAI, Anthropic, Cohere
2. **Payment Processing** - Stripe, PayPal
3. **Database** - DATABASE_URL, connection strings
4. **Cache / Queue** - Redis, RabbitMQ
5. **Authentication** - NextAuth, Auth0, Clerk
6. **Email** - SendGrid, Resend, Postmark
7. **Storage** - AWS S3, Cloudflare R2
8. **Monitoring** - Sentry, LogRocket
9. **Other Services** - Everything else

### Dashboard URLs

Includes helpful URLs for common providers:

| Provider | Dashboard URL |
|----------|--------------|
| OpenAI | https://platform.openai.com/api-keys |
| Anthropic | https://console.anthropic.com/settings/keys |
| Stripe | https://dashboard.stripe.com/apikeys |
| Vercel | https://vercel.com/account/tokens |
| Supabase | https://supabase.com/dashboard/project/_/settings/api |

### Sync Mode

With `--sync`, the skill:
- Preserves existing custom comments
- Preserves grouping/sections
- Adds new variables found in code or 1Password
- Asks before removing unused variables

---

## Integration with Other Skills

### /security

The security audit suite includes a shortcut:

```bash
/security secrets-1p    # Runs /secrets-audit
```

### /deploy-check

Pre-deployment checklist recommends:
- Run `/secrets-audit` for comprehensive secrets check
- All env vars stored in 1Password

### /new-project

The Available Commands section includes both skills for quick reference.

---

## Best Practices

### Before Every Deployment

```bash
# 1. Check for hardcoded secrets
/secrets-audit

# 2. Ensure .env.example is current
/env-example --sync

# 3. Deploy env vars to platform
/deploy-env vercel production
```

### When Adding New API Keys

```bash
# 1. Store in 1Password (automatic via MCP)
# 2. Update .env.example
/env-example --sync

# 3. Verify nothing is hardcoded
/secrets-audit --quick
```

### Weekly Security Audit

```bash
# Full audit with 1Password cross-check
/secrets-audit

# Or use the security suite
/security secrets-1p
```
